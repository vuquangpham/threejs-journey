"use strict";(self.webpackChunkthreejs_journey=self.webpackChunkthreejs_journey||[]).push([[953],{953:(e,t,r)=>{r.r(t),r.d(t,{default:()=>c});var o=r(9477),n=r(9365),a=r(3867),s=r(8243),i=r(2666),d=r(2854);const c=class{constructor(e){let{element:t}=e;this.element=t,this.init()}init(){o.epp.enabled=!1;const e=new s.ZP,t={};e.add(o.epp,"enabled");const r=new i.x,c=new d._;c.setDecoderPath("/draco/");const l=new a.E;l.setDRACOLoader(c);const h=document.querySelector("canvas#webgl"),u=new o.xsS,p=()=>{u.traverse((e=>{e.isMesh&&e.material.isMeshStandardMaterial&&(e.material.envMapIntensity=t.envMapIntensity,e.castShadow=!0,e.receiveShadow=!0)}))};t.envMapIntensity=1,e.add(t,"envMapIntensity").min(0).max(10).step(.001).onChange(p),r.load("/environmentMaps/0/2k.hdr",(e=>{e.mapping=o.dSO,u.background=e,u.environment=e})),l.load("/models/Hamburger/glTF-Binary/Hamburger.glb",(e=>{e.scene.scale.set(.4,.4,.4),e.scene.position.y=2.5,u.add(e.scene),p()}));const w=new o.dpR,f=w.load("/textures/wood_cabinet_worn_long/wood_cabinet_worn_long_diff_1k.jpg"),m=w.load("/textures/wood_cabinet_worn_long/wood_cabinet_worn_long_arm_1k.jpg"),g=w.load("/textures/wood_cabinet_worn_long/wood_cabinet_worn_long_nor_gl_1k.png"),y=w.load("/textures/castle_brick_broken_06/castle_brick_broken_06_diff_1k.jpg"),_=w.load("/textures/castle_brick_broken_06/castle_brick_broken_06_arm_1k.jpg"),b=w.load("/textures/castle_brick_broken_06/castle_brick_broken_06_nor_gl_1k.png");y.colorSpace=o.KI_,f.colorSpace=o.KI_;const k=new o.Kj0(new o._12(8,8),new o.Wid({aoMap:m,roughnessMap:m,metalnessMap:m,map:f,normalMap:g}));k.rotation.x=.5*-Math.PI,u.add(k);const L=new o.Kj0(new o._12(8,8),new o.Wid({aoMap:_,roughnessMap:_,metalnessMap:_,map:y,normalMap:b}));L.position.set(0,4,-4),u.add(L);const A={width:window.innerWidth,height:window.innerHeight};window.addEventListener("resize",(()=>{A.width=window.innerWidth,A.height=window.innerHeight,x.aspect=A.width/A.height,x.updateProjectionMatrix(),M.setSize(A.width,A.height),M.setPixelRatio(Math.min(window.devicePixelRatio,2))}));const x=new o.cPb(75,A.width/A.height,.1,100);x.position.set(4,5,4),u.add(x);const E=new n.z(x,h);E.target.y=3.5,E.enableDamping=!0;const R=new o.Ox3("#fff",2);R.position.set(3,7,6),R.shadow.camera.far=15,R.shadow.mapSize.set(1024,1024),e.add(R,"intensity").min(0).max(10).step(.001).name("lightIntensity"),e.add(R.position,"x").min(-10).max(10).step(.001).name("lightX"),e.add(R.position,"y").min(-10).max(10).step(.001).name("lightY"),e.add(R.position,"z").min(-10).max(10).step(.001).name("lightZ");const T=new o.Rki(R.shadow.camera);u.add(T),R.target.position.set(0,4,0),R.target.updateMatrixWorld(),R.castShadow=!0,e.add(R,"castShadow"),e.add(R.shadow,"normalBias").min(-.05).max(.05).step(.001),e.add(R.shadow,"bias").min(-.05).max(.05).step(.001),R.shadow.normalBias=.027,R.shadow.bias=-.004,u.add(R);const M=new o.CP7({canvas:h,antialias:!0});M.setSize(A.width,A.height),M.setPixelRatio(Math.min(window.devicePixelRatio,2)),M.toneMapping=o.CdI,e.add(M,"toneMapping",{No:o.uL9,Linear:o.EoG,Reinhard:o.CdI,Cineon:o.YGz,ACESFilmic:o.LY2}),M.toneMappingExposure=3,e.add(M,"toneMappingExposure").min(0).max(10).step(.001),M.useLegacyLights=!1,e.add(M,"useLegacyLights"),M.shadowMap.enabled=!0,M.shadowMap.type=o.ntZ;const C=()=>{E.update(),M.render(u,x),window.requestAnimationFrame(C)};C()}destroy(){console.log("destroyed",this)}}},2854:(e,t,r)=>{r.d(t,{_:()=>a});var o=r(9477);const n=new WeakMap;class a extends o.aNw{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,r,n){const a=new o.hH6(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(e=>{this.parse(e,t,n)}),r,n)}parse(e,t,r){this.decodeDracoFile(e,t,null,null,o.KI_).catch(r)}decodeDracoFile(e,t,r,n,a=o.GUF){const s={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:n||this.defaultAttributeTypes,useUniqueIDs:!!r,vertexColorSpace:a};return this.decodeGeometry(e,s).then(t)}decodeGeometry(e,t){const r=JSON.stringify(t);if(n.has(e)){const t=n.get(e);if(t.key===r)return t.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let o;const a=this.workerNextTaskID++,s=e.byteLength,i=this._getWorker(a,s).then((r=>(o=r,new Promise(((r,n)=>{o._callbacks[a]={resolve:r,reject:n},o.postMessage({type:"decode",id:a,taskConfig:t,buffer:e},[e])}))))).then((e=>this._createGeometry(e.geometry)));return i.catch((()=>!0)).then((()=>{o&&a&&this._releaseTask(o,a)})),n.set(e,{key:r,promise:i}),i}_createGeometry(e){const t=new o.u9r;e.index&&t.setIndex(new o.TlE(e.index.array,1));for(let r=0;r<e.attributes.length;r++){const n=e.attributes[r],a=n.name,s=n.array,i=n.itemSize,d=new o.TlE(s,i);"color"===a&&(this._assignVertexColorSpace(d,n.vertexColorSpace),d.normalized=s instanceof Float32Array==!1),t.setAttribute(a,d)}return t}_assignVertexColorSpace(e,t){if(t!==o.KI_)return;const r=new o.Ilk;for(let t=0,o=e.count;t<o;t++)r.fromBufferAttribute(e,t).convertSRGBToLinear(),e.setXYZ(t,r.r,r.g,r.b)}_loadLibrary(e,t){const r=new o.hH6(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),r.setWithCredentials(this.withCredentials),new Promise(((t,o)=>{r.load(e,t,void 0,o)}))}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then((t=>{const r=t[0];e||(this.decoderConfig.wasmBinary=t[1]);const o=s.toString(),n=["/* draco decoder */",r,"","/* worker */",o.substring(o.indexOf("{")+1,o.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([n]))})),this.decoderPending}_getWorker(e,t){return this._initDecoder().then((()=>{if(this.workerPool.length<this.workerLimit){const e=new Worker(this.workerSourceURL);e._callbacks={},e._taskCosts={},e._taskLoad=0,e.postMessage({type:"init",decoderConfig:this.decoderConfig}),e.onmessage=function(t){const r=t.data;switch(r.type){case"decode":e._callbacks[r.id].resolve(r);break;case"error":e._callbacks[r.id].reject(r);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+r.type+'"')}},this.workerPool.push(e)}else this.workerPool.sort((function(e,t){return e._taskLoad>t._taskLoad?-1:1}));const r=this.workerPool[this.workerPool.length-1];return r._taskCosts[e]=t,r._taskLoad+=t,r}))}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map((e=>e._taskLoad)))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,""!==this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),this}}function s(){let e,t;function r(e,t,r,o,n,a){const s=a.num_components(),i=r.num_points()*s,d=i*n.BYTES_PER_ELEMENT,c=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,n),l=e._malloc(d);t.GetAttributeDataArrayForAllPoints(r,a,c,d,l);const h=new n(e.HEAPF32.buffer,l,i).slice();return e._free(l),{name:o,array:h,itemSize:s}}onmessage=function(o){const n=o.data;switch(n.type){case"init":e=n.decoderConfig,t=new Promise((function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)}));break;case"decode":const o=n.buffer,a=n.taskConfig;t.then((e=>{const t=e.draco,s=new t.Decoder;try{const e=function(e,t,o,n){const a=n.attributeIDs,s=n.attributeTypes;let i,d;const c=t.GetEncodedGeometryType(o);if(c===e.TRIANGULAR_MESH)i=new e.Mesh,d=t.DecodeArrayToMesh(o,o.byteLength,i);else{if(c!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");i=new e.PointCloud,d=t.DecodeArrayToPointCloud(o,o.byteLength,i)}if(!d.ok()||0===i.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+d.error_msg());const l={index:null,attributes:[]};for(const o in a){const d=self[s[o]];let c,h;if(n.useUniqueIDs)h=a[o],c=t.GetAttributeByUniqueId(i,h);else{if(h=t.GetAttributeId(i,e[a[o]]),-1===h)continue;c=t.GetAttribute(i,h)}const u=r(e,t,i,o,d,c);"color"===o&&(u.vertexColorSpace=n.vertexColorSpace),l.attributes.push(u)}c===e.TRIANGULAR_MESH&&(l.index=function(e,t,r){const o=r.num_faces(),n=3*o,a=4*n,s=e._malloc(a);t.GetTrianglesUInt32Array(r,a,s);const i=new Uint32Array(e.HEAPF32.buffer,s,n).slice();return e._free(s),{array:i,itemSize:1}}(e,t,i));return e.destroy(i),l}(t,s,new Int8Array(o),a),i=e.attributes.map((e=>e.array.buffer));e.index&&i.push(e.index.array.buffer),self.postMessage({type:"decode",id:n.id,geometry:e},i)}catch(e){console.error(e),self.postMessage({type:"error",id:n.id,error:e.message})}finally{t.destroy(s)}}))}}}},2666:(e,t,r)=>{r.d(t,{x:()=>n});var o=r(9477);class n extends o.yxD{constructor(e){super(e),this.type=o.cLu}parse(e){const t=function(e,t){switch(e){case 1:console.error("THREE.RGBELoader Read Error: "+(t||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(t||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(t||""));break;default:console.error("THREE.RGBELoader: Error: "+(t||""))}return-1},r=function(e,t,r){t=t||1024;let o=e.pos,n=-1,a=0,s="",i=String.fromCharCode.apply(null,new Uint16Array(e.subarray(o,o+128)));for(;0>(n=i.indexOf("\n"))&&a<t&&o<e.byteLength;)s+=i,a+=i.length,o+=128,i+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(o,o+128)));return-1<n&&(!1!==r&&(e.pos+=a+n+1),s+i.slice(0,n))},n=function(e,t,r,o){const n=e[t+3],a=Math.pow(2,n-128)/255;r[o+0]=e[t+0]*a,r[o+1]=e[t+1]*a,r[o+2]=e[t+2]*a,r[o+3]=1},a=function(e,t,r,n){const a=e[t+3],s=Math.pow(2,a-128)/255;r[n+0]=o.A5E.toHalfFloat(Math.min(e[t+0]*s,65504)),r[n+1]=o.A5E.toHalfFloat(Math.min(e[t+1]*s,65504)),r[n+2]=o.A5E.toHalfFloat(Math.min(e[t+2]*s,65504)),r[n+3]=o.A5E.toHalfFloat(1)},s=new Uint8Array(e);s.pos=0;const i=function(e){const o=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,n=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,a=/^\s*FORMAT=(\S+)\s*$/,s=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,i={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let d,c;if(e.pos>=e.byteLength||!(d=r(e)))return t(1,"no header found");if(!(c=d.match(/^#\?(\S+)/)))return t(3,"bad initial token");for(i.valid|=1,i.programtype=c[1],i.string+=d+"\n";d=r(e),!1!==d;)if(i.string+=d+"\n","#"!==d.charAt(0)){if((c=d.match(o))&&(i.gamma=parseFloat(c[1])),(c=d.match(n))&&(i.exposure=parseFloat(c[1])),(c=d.match(a))&&(i.valid|=2,i.format=c[1]),(c=d.match(s))&&(i.valid|=4,i.height=parseInt(c[1],10),i.width=parseInt(c[2],10)),2&i.valid&&4&i.valid)break}else i.comments+=d+"\n";return 2&i.valid?4&i.valid?i:t(3,"missing image size specifier"):t(3,"missing format specifier")}(s);if(-1!==i){const e=i.width,r=i.height,d=function(e,r,o){const n=r;if(n<8||n>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);if(n!==(e[2]<<8|e[3]))return t(3,"wrong scanline width");const a=new Uint8Array(4*r*o);if(!a.length)return t(4,"unable to allocate buffer space");let s=0,i=0;const d=4*n,c=new Uint8Array(4),l=new Uint8Array(d);let h=o;for(;h>0&&i<e.byteLength;){if(i+4>e.byteLength)return t(1);if(c[0]=e[i++],c[1]=e[i++],c[2]=e[i++],c[3]=e[i++],2!=c[0]||2!=c[1]||(c[2]<<8|c[3])!=n)return t(3,"bad rgbe scanline format");let r,o=0;for(;o<d&&i<e.byteLength;){r=e[i++];const n=r>128;if(n&&(r-=128),0===r||o+r>d)return t(3,"bad scanline data");if(n){const t=e[i++];for(let e=0;e<r;e++)l[o++]=t}else l.set(e.subarray(i,i+r),o),o+=r,i+=r}const u=n;for(let e=0;e<u;e++){let t=0;a[s]=l[e+t],t+=n,a[s+1]=l[e+t],t+=n,a[s+2]=l[e+t],t+=n,a[s+3]=l[e+t],s+=4}h--}return a}(s.subarray(s.pos),e,r);if(-1!==d){let t,s,c;switch(this.type){case o.VzW:c=d.length/4;const e=new Float32Array(4*c);for(let t=0;t<c;t++)n(d,4*t,e,4*t);t=e,s=o.VzW;break;case o.cLu:c=d.length/4;const r=new Uint16Array(4*c);for(let e=0;e<c;e++)a(d,4*e,r,4*e);t=r,s=o.cLu;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type)}return{width:e,height:r,data:t,header:i.string,gamma:i.gamma,exposure:i.exposure,type:s}}}return null}setDataType(e){return this.type=e,this}load(e,t,r,n){return super.load(e,(function(e,r){switch(e.type){case o.VzW:case o.cLu:e.colorSpace=o.GUF,e.minFilter=o.wem,e.magFilter=o.wem,e.generateMipmaps=!1,e.flipY=!0}t&&t(e,r)}),r,n)}}}}]);